---
title: 1.1 Buffer
tags:
  - NIO 
  - Socket
cover: /cover/blog/nio/1.png
createTime: 2022/05/06 16:18:28
permalink: /nio/87wfm477/
---

## 1.1 NIO简介
&nbsp;&nbsp;NIO（New Input/Output）是一个可以替代标准Java IO API的Java API，提供了高速的面向缓冲区的I/O操作。NIO使我们可以进行异步I/O操作，并且扩展性更高。

&nbsp;&nbsp;NIO主要有三大核心部分：`Selector（选择器）`、`Buffer（缓冲区）`、`Channel（通道）`。

### **Selector（选择器）**<br/>
&nbsp;&nbsp;用于监听多个通道的事件（如：连接打开，数据到达）。因此，单个线程可以监听多个数据通道。

### **Channel（通道）**<br/>
&nbsp;&nbsp;类似于流，但可以同时进行读写，通道是双向的。通道可以比流更好地反映底层操作系统的真实情况。特别是在Unix网络编程中，底层操作系统的通道是双向的。

### **Buffer（缓冲区）**<br/>
&nbsp;&nbsp;用于和通道进行交互。数据是从通道读入缓冲区，从缓冲区写入通道中的。


## 1.2 Buffer简介
&nbsp;&nbsp;Buffer是一个对象，它包含一些要写入或者要读出的数据。在NIO中，所有数据都是用缓冲区处理的。在读取数据时，它是直接读到缓冲区中的；在写入数据时，写入到缓冲区中。**缓冲区实际上是一个数组**。

&nbsp;&nbsp;缓冲区在NIO中非常重要，因为缓冲区包含的数据就是进行网络传输的数据。在NIO中，缓冲区是**非直接缓冲区**和**直接缓冲区**。

### **非直接缓冲区**<br/>
&nbsp;&nbsp;非直接缓冲区是分配在JVM堆内存中的缓冲区，因此，非直接缓冲区的分配和释放都由JVM进行管理。

### **直接缓冲区**<br/>
&nbsp;&nbsp;直接缓冲区是直接分配在物理内存中的缓冲区，因此，直接缓冲区的分配和释放都由操作系统进行管理。直接缓冲区的分配和释放比非直接缓冲区的分配和释放要慢，但是直接缓冲区的数据传输效率比非直接缓冲区要高。
&nbsp;&nbsp;直接缓冲区是通过`allocateDirect()`方法分配的，非直接缓冲区是通过`allocate()`方法分配的。

&nbsp;&nbsp;在NIO中，缓冲区是线程安全的，因此，多个线程可以同时操作一个缓冲区，但是，在操作缓冲区时，需要使用同步机制来保证线程安全。

